# Диагностика схемы базы данных

## Проблема

Продолжаются ошибки с полями базы данных:
- `'record "new" has no field "order_date"'` (code: 42703)

## Диагностика

### 1. Проверка схемы таблицы

Добавлен API эндпоинт для проверки реальной структуры таблицы:
```
GET /api/debug/table-schema
```

Этот эндпоинт покажет:
- Реальные названия колонок в базе данных
- Типы данных
- Пример ключей из существующих записей

### 2. Обновленная логика вставки

API теперь пробует оба формата:

1. **Сначала quoted camelCase**:
   ```javascript
   {
     "orderDate": value,
     "orderNumber": value,
     "shipmentNumber": value,
     "productType": value
   }
   ```

2. **Если не работает, то snake_case**:
   ```javascript
   {
     order_date: value,
     order_number: value,
     shipment_number: value,
     product_type: value
   }
   ```

### 3. Детальное логирование

Добавлены логи для каждого шага:
- Подготовка данных в обоих форматах
- Попытка вставки с quoted camelCase
- Fallback на snake_case при ошибке 42703
- Результат каждой попытки

## Следующие шаги

1. **Попробуйте создать заказ** - API автоматически определит правильный формат
2. **Проверьте логи** в консоли браузера и Vercel
3. **Вызовите GET /api/debug/table-schema** для проверки реальной структуры таблицы
4. **Отправьте результаты** для окончательного исправления

## Ожидаемый результат

После этого обновления мы точно определим правильный формат полей и исправим проблему навсегда. 